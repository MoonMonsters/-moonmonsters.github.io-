title: '[转]如果让你来设计网络'
tags: []
categories: []
date: 2021-03-26 15:36:00
---
### 转载
[低并发编程-如果让你来设计网络](https://mp.weixin.qq.com/s/jiPMUk6zUdOY6eKxAjNDbQ)


### 描述
你是一台电脑，你的名字叫 A <br/>
很久很久之前，你不与任何其他电脑相连接，孤苦伶仃。
![](https://qxinhai.oss-cn-shenzhen.aliyuncs.com/hexo/20210326153940.png)

直到有一天，你希望与另一台电脑 B 建立通信，于是你们各开了一个网口，用一根网线连接了起来。
![](https://qxinhai.oss-cn-shenzhen.aliyuncs.com/hexo/20210326154000.png)

用一根网线连接起来怎么就能"通信"了呢？我可以给你讲 IO、讲中断、讲缓冲区，但这不是研究网络时该关心的问题。

如果你纠结，要么去研究一下操作系统是如何处理网络 IO 的，要么去研究一下包是如何被网卡转换成电信号发送出去的，要么就仅仅把它当做电脑里有个小人在开枪吧~
![](https://qxinhai.oss-cn-shenzhen.aliyuncs.com/hexo/20210326154616.gif)

反正，你们就是连起来了，并且可以通信。


### 第一层
有一天，一个新伙伴 C 加入了，但聪明的你们很快发现，可以每个人开两个网口，用一共三根网线，彼此相连。
![](https://qxinhai.oss-cn-shenzhen.aliyuncs.com/hexo/20210326154818.png)
随着越来越多的人加入，你发现身上开的网口实在太多了，而且网线密密麻麻，混乱不堪。（`而实际上一台电脑根本开不了这么多网口，所以这种连线只在理论上可行，所以连不上的我就用红色虚线表示了，就是这么严谨哈哈~`）
![](https://qxinhai.oss-cn-shenzhen.aliyuncs.com/hexo/20210326154843.png)

于是你们发明了一个中间设备，你们将网线都插到这个设备上，由这个设备做转发，就可以彼此之间通信了，本质上和原来一样，只不过网口的数量和网线的数量减少了，不再那么混乱。
![](https://qxinhai.oss-cn-shenzhen.aliyuncs.com/hexo/20210326154912.png)

你给它取名叫`集线器`，它仅仅是无脑将电信号转发到所有出口（广播），不做任何处理，你觉得它是没有智商的，因此把人家定性在了`物理层`。
![图片](https://qxinhai.oss-cn-shenzhen.aliyuncs.com/hexo/20210326155001.gif)

由于转发到了所有出口，那 BCDE 四台机器怎么知道数据包是不是发给自己的呢？

首先，你要给所有的连接到集线器的设备，都起个名字。原来你们叫 ABCD，但现在需要一个更专业的，全局唯一的名字作为标识，你把这个更高端的名字称为 MAC 地址。

你的 MAC 地址是 aa-aa-aa-aa-aa-aa，你的伙伴 b 的 MAC 地址是 bb-bb-bb-bb-bb-bb，以此类推，不重复就好。

这样，A 在发送数据包给 B 时，只要在头部拼接一个这样结构的数据，就可以了。




